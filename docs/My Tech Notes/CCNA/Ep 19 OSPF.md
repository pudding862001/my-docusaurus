---
title: Ep 19 Open Shortest Path First (OSPF)
sidebar_label: Ep 19 OSPF
sidebar_position: 19
---

In this episode, we explore **Open Shortest Path First (OSPF)**, one of the most widely used Interior Gateway Protocols (IGP) in enterprise networks. OSPF is a link-state routing protocol that uses the **Shortest Path First (SPF)** algorithm (Dijkstra's algorithm) to calculate the best path to a destination.

---

## 1. OSPF Characteristics

* **Protocol Type**: Link-State Routing Protocol.
* **Algorithm**: Dijkstra's Shortest Path First (SPF) algorithm.
* **Administrative Distance (AD)**: 110.
* **Metric**: **Cost**, calculated based on the bandwidth of the interface (Reference Bandwidth / Interface Bandwidth).
* **Multicast Addresses**: 
    * **224.0.0.5**: All OSPF routers.
    * **224.0.0.6**: All Designated Routers (DR).
* **Hierarchy**: Uses **Areas** to limit the scope of routing updates and improve scalability. Area 0 is the **Backbone Area**, and all other areas must connect to it.

---

## 2. OSPF Neighbor Adjacency

Before routers can exchange routing information, they must become neighbors. This process involves several states:

1.  **Down**: No OSPF information has been received.
2.  **Init**: A Hello packet is received, but the local router's ID is not yet in the neighbor's list.
3.  **Two-Way**: Bidirectional communication is established. In multi-access networks, DR/BDR election occurs here.
4.  **ExStart**: Routers determine the Master/Slave relationship for the exchange.
5.  **Exchange**: Routers exchange Database Description (DBD) packets.
6.  **Loading**: Routers request missing or more recent information using LSRs (Link State Requests).
7.  **Full**: The Link State Databases (LSDB) are fully synchronized.

### Neighbor Requirements:
To become neighbors, routers must match on the following:
* Area ID
* Subnet Mask
* Hello and Dead Timers
* Authentication Password (if used)
* MTU (must match to reach Full state)

---

## 3. Router ID and DR/BDR Election

### OSPF Router ID (RID)
The RID is a unique 32-bit identifier for each router in an OSPF process. It is selected in the following order:
1.  Manually configured RID (using `router-id` command).
2.  Highest IP address among active loopback interfaces.
3.  Highest IP address among active physical interfaces.

### DR and BDR Election
In multi-access networks (like Ethernet), OSPF elects a **Designated Router (DR)** and a **Backup Designated Router (BDR)** to minimize the number of adjacencies and LSA flooding.
* **Election Criteria**: Highest OSPF Interface Priority wins (Default is 1). If tied, the highest Router ID wins.
* **Priority 0**: A router with priority 0 can never become a DR or BDR.
* **Non-Preemptive**: Once a DR is elected, it remains the DR until it fails or the OSPF process is restarted.

---

## 4. OSPF Areas and LSAs

OSPF uses a two-layer hierarchy to manage large networks:
* **Backbone Area (Area 0)**: The core of the OSPF network.
* **Standard Areas**: Non-backbone areas that contain end users and resources.

Routers use **Link State Advertisements (LSAs)** to share topology information:
* **Type 1 (Router LSA)**: Generated by every router, describes its own links within an area.
* **Type 2 (Network LSA)**: Generated by the DR, describes the routers connected to a multi-access segment.
* **Type 3 (Summary LSA)**: Generated by an Area Border Router (ABR), describes routes to other areas.

---

## 5. Configuration and Verification

### Basic OSPF Configuration

```bash
# Enable OSPF process (ID 1 is local to the router)
R1(config)# router ospf 1

# Manually set the Router ID
R1(config-router)# router-id 1.1.1.1

# Advertise networks and assign them to an area
# Format: network [network_address] [wildcard_mask] area [area_id]
R1(config-router)# network 192.168.1.0 0.0.0.255 area 0
R1(config-router)# network 10.1.1.0 0.0.0.3 area 0

# (Optional) Set OSPF priority to influence DR election
R1(config)# interface g0/0
R1(config-if)# ip ospf priority 100
```

### Verification Commands

```bash
# Check OSPF neighbor status and states (Expect: FULL/DR, FULL/BDR, or 2WAY/DROTHER)
show ip ospf neighbor

# View the OSPF routing table (marked with 'O' or 'O IA')
show ip route ospf

# View OSPF process details, ID, and timers
show ip protocols

# Verify OSPF interface specific settings (Hello timers, Priority, DR/BDR info)
show ip ospf interface g0/0

# View the OSPF topology database
show ip ospf database
```

---